import{a as M,r as k,R as N,o as i,e as n,f as e,F as D,x,t as V,J as O,K as F,y as j,I as z,q as o,C as U,h as p,g as c,E as B,D as C,j as b,A as I,c as T,n as g,Z as w,a1 as S}from"./app-CSosM33B.js";import{L as P,a as q,b as H}from"./lineChartData-CwsXh-Xh.js";import{A as J}from"./arrayUtil-1UUyiO7U.js";import{E as A,a as K}from"./index-CjUXJ7DM.js";import"./objectUtil-Z6JRxuBJ.js";import"./viewUtil-C7po9rYW.js";import"./_commonjsHelpers-Cpj98o6Y.js";import"./index-B69GrENz.js";import"./focus-trap-oW3Oz0pJ.js";import"./index-CwAalyKH.js";import"./isUndefined-DCTLXrZ8.js";import"./_baseIteratee-CcDVmX61.js";import"./isEqual-B2A1MZL7.js";import"./merge-_9lU3S1-.js";import"./_initCloneObject-C1N_ki7v.js";import"./isArrayLikeObject-C0bNowXW.js";import"./index-DpC6it7c.js";const R=h=>(O("data-v-f9336731"),h=h(),F(),h),W={class:"pl-4"},X=R(()=>e("div",{class:"mb-2"}," Server Infos: ",-1)),Z={class:"flex flex-col gap-y-1"},G={class:"var-name"},Y={class:"select-all"},tt=M({__name:"MySQLBasic",props:{variableList:{}},setup(h){const s=h,t=k({}),f=[{name:"Port",value:"report_port"},{name:"Version",value:"version"},{name:"Slow Query Log",value:"slow_query_log"},{name:"Performance Schema",value:"performance_schema"},{name:"Base Directory",value:"basedir"},{name:"Data Directory",value:"datadir"}];N(()=>{t.value=J.arrayToObj(s.variableList.rows,a=>a.Variable_name,"Value")});const L=a=>t.value[a];return(a,v)=>(i(),n("div",W,[X,e("div",Z,[(i(),n(D,null,x(f,_=>e("div",{key:_.name,class:"flex gap-x-2 flex-wrap shrink-0"},[e("div",G,V(_.name)+":",1),e("div",Y,V(L(_.value)),1)])),64))])]))}}),et=j(tt,[["__scopeId","data-v-f9336731"]]),st={class:"pl-2 my-1"},at={class:"text-center"},it=M({__name:"Process",setup(h){const s=k(0),t=k({fields:[],rows:[],supportKill:!1});function f(a){return a.match(/SQL|INFO|SQL_TEXT/i)?null:a==="Host"?150:100}function L(a){o.emit("killProcess",a)}return z(()=>{o.on("processList",v=>{t.value=v}),o.emit("processList");const a=()=>{s.value=window.innerHeight-110};a(),window.addEventListener("resize",a)}),(a,v)=>{const _=U("vsc-button"),y=A,r=K;return i(),n("div",null,[e("div",st,[p(_,{type:"icon",icon:"codicon-refresh text-base",title:a.$t("common.refresh"),onClick:v[0]||(v[0]=u=>c(o).emit("processList"))},null,8,["title"])]),p(r,{data:t.value.rows,height:s.value,border:""},{default:B(()=>[(i(!0),n(D,null,x(t.value.fields,(u,l)=>(i(),C(y,{key:l,prop:u.name,label:u.name,align:"center",width:f(u.name)},null,8,["prop","label","width"]))),128)),t.value.supportKill?(i(),C(y,{key:0,label:"Action",align:"center",width:"70"},{default:B(({row:u})=>[e("div",at,[p(_,{type:"icon",icon:"codicon-debug-stop",class:"red",title:"Kill",onClick:l=>L(u)},null,8,["onClick"])])]),_:1})):b("",!0)]),_:1},8,["data","height"])])}}}),ot={class:"status-container"},lt={class:"tab"},nt={class:"flex flex-row",style:{height:"45vh","margin-top":"10px"}},rt={class:"basis-1/3"},ct={class:"basis-2/3"},ut=e("span",{class:"select-none"},"Traffic:",-1),dt={style:{height:"300px"}},pt={class:"flex"},vt={class:"basis-full"},_t=e("span",{class:"select-none"},"Queries:",-1),mt={style:{height:"300px"}},Et=M({__name:"status",setup(h){const s=k("processList"),t=I({info:{dbType:null},process:{fields:[],rows:[]},variableList:{fields:[],rows:[]},statusList:{fields:[],rows:[]}}),f=new P,L=new P;function a(){r.dashBoard&&o.emit("dashBoard")}function v(){return window.innerHeight-80}const _=f.toChartData(),y=L.toChartData(),r=I({processList:!0,dashBoard:T(()=>["MariaDB","MySQL"].includes(t.info.dbType)),variableList:T(()=>["MariaDB","MySQL","PostgreSQL"].includes(t.info.dbType)),statusList:T(()=>["MariaDB","MySQL","PostgreSQL"].includes(t.info.dbType))});function u(){a(),o.emit("processList"),r.variableList&&o.emit("variableList"),r.statusList&&o.emit("statusList")}return o.on("info",l=>{t.info=l,r[s.value]||(s.value="processList"),u()}).on("variableList",l=>{t.variableList=l}).on("statusList",l=>{t.statusList=l}).on("dashBoard",l=>{L.addData(l.traffic),f.addData(l.queries)}).init("status"),window.addEventListener("focus",()=>{o.init("status")}),u(),setTimeout(()=>a(),1e3),setInterval(()=>a(),3e3),(l,m)=>{const Q=A,E=K;return i(),n("div",ot,[e("ul",lt,[r.dashBoard?(i(),n("li",{key:0,class:g(["tab__item",{"tab__item--active":s.value=="dashBoard"}]),onClick:m[0]||(m[0]=d=>{s.value="dashBoard",a()})}," Dashboard ",2)):b("",!0),r.processList?(i(),n("li",{key:1,class:g(["tab__item",{"tab__item--active":s.value=="processList"}]),onClick:m[1]||(m[1]=d=>{s.value="processList",c(o).emit("processList")})}," ProcessList ",2)):b("",!0),r.variableList?(i(),n("li",{key:2,class:g(["tab__item",{"tab__item--active":s.value=="variableList"}]),onClick:m[2]||(m[2]=d=>{s.value="variableList",c(o).emit("variableList")})}," VariableList ",2)):b("",!0),r.statusList?(i(),n("li",{key:3,class:g(["tab__item",{"tab__item--active":s.value=="statusList"}]),onClick:m[3]||(m[3]=d=>{s.value="statusList",c(o).emit("statusList")})}," StatusList ",2)):b("",!0)]),w(e("div",null,[e("div",nt,[e("div",rt,[p(et,{variableList:t.variableList},null,8,["variableList"])]),e("div",ct,[ut,e("div",dt,[p(c(H),{options:c(q).getOption(!0),data:c(y)},null,8,["options","data"])])])]),e("div",pt,[e("div",vt,[_t,e("div",mt,[p(c(H),{options:c(q).getOption(),data:c(_)},null,8,["options","data"])])])])],512),[[S,["MariaDB","MySQL"].includes(t.info.dbType)&&s.value=="dashBoard"]]),w(p(it,null,null,512),[[S,s.value=="processList"]]),w(e("div",null,[p(E,{data:t.variableList.rows,"cell-style":{height:"35px"},style:{width:"100%"},height:v()},{default:B(()=>[(i(!0),n(D,null,x(t.variableList.fields,(d,$)=>(i(),C(Q,{key:$,prop:d.name,label:d.name,align:"center"},null,8,["prop","label"]))),128))]),_:1},8,["data","height"])],512),[[S,t.info.dbType!="SqlServer"&&s.value=="variableList"]]),w(e("div",null,[p(E,{data:t.statusList.rows,"cell-style":{height:"35px"},style:{width:"100%"},height:v()},{default:B(()=>[(i(!0),n(D,null,x(t.statusList.fields,(d,$)=>(i(),C(Q,{key:$,prop:d.name,label:d.name,align:"center"},null,8,["prop","label"]))),128))]),_:1},8,["data","height"])],512),[[S,t.info.dbType!="SqlServer"&&s.value=="statusList"]])])}}});export{Et as default};
