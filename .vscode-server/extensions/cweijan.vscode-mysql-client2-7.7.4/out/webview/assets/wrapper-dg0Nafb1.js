import{D as n,d as c}from"./constants-BpYHMiwN.js";import{i as f,b as i,c as l}from"./viewUtil-C7po9rYW.js";class m{isSupport(e){return f(e)}convert(e,t,s){if(t.startsWith("0x")){const u=t.slice(2);switch(s){case n.PG:return`'\\x${u}'`;case n.REDSHIFT:return`from_hex('${u}')`;case n.libSQL:case n.SQLITE:case n.DUCK_DB:return`x'${u}'`;case n.SNOWFLAKE:return`TO_BINARY('${u}', 'hex')`}return t}else switch(s){case n.DB2:return`CAST('${t}' AS BLOB)`;case n.SQLServer:return`CAST('${t}' AS varbinary)`;case n.ORACLE:return`rawtohex('${t}')`;case n.CASSANDRA:return`textAsBlob('${t}')`}}}class S{isSupport(e){return e.match(/DATE/i)!=null}convert(e,t,s){switch(s){case n.TRINO:return`from_iso8601_timestamp('${t}')`;case n.ORACLE:return`TO_DATE('${t}','yyyy/mm/dd hh24:mi:ss')`}}}class A{isSupport(e,t,s){return s==n.ORACLE&&e.match(/TIMESTAMP/i)!=null}convert(e,t,s){return`TO_TIMESTAMP('${t}','yyyy/mm/dd hh24:mi:ss')`}}function L(r){return r==null?!0:typeof r=="string"?["","NULL","undefined"].includes(r.toUpperCase()):!1}function o(r,e){if(a(r)&&typeof e=="string"){if(/boolean/i.test(r)){if(/^true$/i.test(e))return!0;if(/^false$/i.test(e))return!1}const t=/float|double|decimal/i.test(r)?parseFloat(e):parseInt(e);if(t!=null&&!isNaN(t))return t}return null}function T(r){return typeof r!="string"?r:r.replace(/ /g," ")}function y(r){return typeof r!="string"?r:r.replace(/(^'|'$)/g,"")}class E{isSupport(e,t,s){return s==n.ES}convert(e,t,s){return o(e,t)??t}}class p{isSupport(e,t,s){return!0}convert(e,t,s){typeof t=="string"&&(t=t.replace(/'/g,"''"));const u=`'${t}'`;return c(s)?u.replace(/\\/g,"\\\\"):u}}class C{isSupport(e,t,s){return a(e)}convert(e,t,s){return o(e,t)}}class N{isSupport(e){return!0}convert(e,t,s){switch(s){case n.CASSANDRA:if(e!=null&&e.match(/uuid/i))return t;break;case n.PG:case n.REDSHIFT:if(t.includes("nextval("))return t;break;case n.SQLServer:if(i(e))return`N'${t}'`;break;case n.TRINO:if(e!=null&&e.match(/json/i))return`json_parse('${t.replace(/'/g,"''").replace(/ /g," ").replace(/\\/g,"\\\\")}')`;break}}}class D{isSupport(e,t,s){return c(s)&&l(e)}convert(e,t,s){if(t.match(/\w+\(/))return`ST_GeomFromText('${t}')`}}const $=[new E,new C,new m,new S,new A,new D,new N,new p];function b(r,e,t){r||(r=""),e=`${e}`;for(const s of $)if(s.isSupport(r,e,t)){const u=s.convert(r,e,t);if(u!=null)return u}}var h=(r=>(r.True="true",r.False="false",r.Never="never",r.Always="always",r.Auto="auto",r))(h||{});function R(r){return r==null?void 0:r.replace(/^[`"\[](.+?)[`"\]]$/,"$1")}function B(r,e,t=!0){if(r==null||["MongoDB"].includes(e)||t=="never"||(t==!0&&(t="always"),t==!1&&(t="auto"),e==n.JDBC&&t=="auto"))return r;const s=r.match(/[A-Z]/g)&&![n.SNOWFLAKE,n.ORACLE,n.DM,n.DB2,n.AS400].includes(e),u=/[~!@#$%^&*()/\s\|,.<>?"'();:+\-=\[\]{}]/;return s||r.match(u)||t=="always"||r.match(/^(user|IF|KEY|DESC|LENGTH|GROUP|GROUPS|ORDER|TABLE|FROM|JOIN|INDEX|CONDITION|SYSTEM|TABLE|TYPE|VALUE|BACKUP|BEGIN|ACCOUNT|ACTION|ALL|ANY|CURRENT|DATA|GRANT|character|explain|union|REGEXP|source|primary|date|condition)$/i)?(r=R(r),[n.MYSQL,n.MARIA_DB,n.DORIS,n.NEO4J,n.BIG_QUERY].includes(e)?`\`${r}\``:`"${r}"`):r}function I(r,e,t){if(t===n.MONGO_DB)return e;if(e==null||e===""&&!i(r))return"null";typeof e=="object"&&(e!=null&&e.origin)&&(e=e.origin),e=T(e);const s=b(r,e,t);if(s!=null)return s}function O(r,e){return a(e)?r:`'${r}'`}function a(r){if(!r||typeof r=="number"||r.includes("[]")||r=="interval")return!1;const e=["int","number","numeric","serial","float","double","decimal","real","bit","bool","boolean"];return!r.match(/point/i)&&r.match(new RegExp(e.join("|"),"i"))!=null}export{h as E,y as a,B as b,L as c,O as g,a as i,T as t,I as w};
